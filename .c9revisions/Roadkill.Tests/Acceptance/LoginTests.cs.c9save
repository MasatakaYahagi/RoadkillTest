{"ts":1354887840889,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"﻿using System;\r\nusing System.Text;\r\nusing System.Collections.Generic;\r\nusing System.Linq;\r\nusing Roadkill.Core;\r\nusing Roadkill.Tests.Core;\r\nusing NUnit.Framework;\r\nusing System.IO;\r\n\r\nusing Plasma.Core;\r\nusing Plasma.WebDriver;\r\nusing OpenQA.Selenium;\r\nusing System.Diagnostics;\r\nusing HtmlAgilityPack;\r\nusing Fizzler.Systems.HtmlAgilityPack;\r\nusing SimpleBrowser.WebDriver;\r\nusing System.Threading;\r\n\r\nnamespace Roadkill.Tests.Acceptance\r\n{\r\n\t/// <summary>\r\n\t/// Web tests using a headless browser (non-javascript interaction)\r\n\t/// </summary>\r\n\t[TestFixture]\r\n\t[Category(\"Acceptance\")]\r\n\t[Explicit]\r\n\tpublic class LoginTests : AcceptanceTestBase\r\n\t{\r\n\t\t[Test]\r\n\t\tpublic void Can_Login_As_Admin()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(LogoutUrl);\r\n\t\t\tDriver.Navigate().GoToUrl(LoginUrl);\r\n\t\t\tDriver.FindElement(By.Name(\"email\")).SendKeys(ADMIN_EMAIL);\r\n\t\t\tDriver.FindElement(By.Name(\"password\")).SendKeys(ADMIN_PASSWORD);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[value=Login]\")).Click();\r\n\t\t\t\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"#loggedinas a\")).Text,Is.EqualTo(\"Logged in as admin\"));\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Can_Login_As_Editor()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(LogoutUrl);\r\n\t\t\tDriver.Navigate().GoToUrl(LoginUrl);\r\n\t\t\tDriver.FindElement(By.Name(\"email\")).SendKeys(EDITOR_EMAIL);\r\n\t\t\tDriver.FindElement(By.Name(\"password\")).SendKeys(EDITOR_PASSWORD);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[value=Login]\")).Click();\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"#loggedinas a\")).Text, Is.EqualTo(\"Logged in as editor\"));\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Incorrect_Email_For_Login_Shows_Error()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(LoginUrl);\r\n\t\t\tDriver.FindElement(By.Name(\"email\")).SendKeys(\"badlogin@roadkillwiki.org\");\r\n\t\t\tDriver.FindElement(By.Name(\"password\")).SendKeys(\"editor\");\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[value=Login]\")).Click();\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\".validation-summary-errors span\")).Text, Is.EqualTo(\"Login was unsuccessful\"));\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Incorrect_Password_For_Admin_ShowsError()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(LoginUrl);\r\n\t\t\tDriver.FindElement(By.Name(\"email\")).SendKeys(ADMIN_EMAIL);\r\n\t\t\tDriver.FindElement(By.Name(\"password\")).SendKeys(\"badpassword\");\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[value=Login]\")).Click();\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\".validation-summary-errors span\")).Text, Is.EqualTo(\"Login was unsuccessful\"));\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Can_Logout_As_Admin()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(LoginUrl);\r\n\t\t\tDriver.FindElement(By.Name(\"email\")).SendKeys(ADMIN_EMAIL);\r\n\t\t\tDriver.FindElement(By.Name(\"password\")).SendKeys(ADMIN_PASSWORD);\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[value=Login]\")).Click();\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"#loggedinas a[href='/user/logout']\")).Click(); // do it by url to be safe\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"#loggedinas a\")).Text, Is.EqualTo(\"Login\"));\t\t\t\r\n\t\t\tstring actual = Driver.FindElement(By.CssSelector(\"#loggedinas\")).Text;\r\n\t\t\tAssert.That(actual, Is.StringContaining(\"Not logged in\"));\r\n\t\t}\r\n\t}\r\n}\r\n"]],"start1":0,"start2":0,"length1":0,"length2":3365}]],"length":3365}
{"contributors":[],"silentsave":false,"ts":1354887766679,"patch":[[{"diffs":[[-1,"﻿"],[0,"usin"]],"start1":0,"start2":0,"length1":5,"length2":4},{"diffs":[[0,")]\r\n"],[-1,"\t[Explicit]\r\n"],[0,"\tpub"]],"start1":585,"start2":585,"length1":21,"length2":8}]],"length":3351,"saved":false}
