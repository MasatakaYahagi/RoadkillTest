{"ts":1362401026341,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"using System;\r\nusing System.Configuration;\r\nusing System.IO;\r\nusing NUnit.Framework;\r\nusing OpenQA.Selenium;\r\nusing OpenQA.Selenium.Support.UI;\r\nusing Roadkill.Core;\r\n\r\nnamespace Roadkill.Tests.Acceptance\r\n{\r\n\t[TestFixture(Description=\"This class has a lot of ajax calls that rely on Thread.Sleeps to complete\")]\r\n\t[Category(\"Acceptance\")]\r\n\t//[Ignore(\"Currently breaking on the CI server - run this locally only\")]\r\n\tpublic class InstallerTests : AcceptanceTestBase\r\n\t{\r\n\t\t[TestFixtureSetUp]\r\n\t\tpublic void TestFixtureSetUp()\r\n\t\t{\r\n\t\t\tConsole.WriteLine(\"--- Starting installer acceptance tests ---\");\r\n\t\t\tAcceptanceTestsSetup.CopyWebConfig();\r\n\t\t}\r\n\r\n\t\t[SetUp]\r\n\t\tpublic void Setup()\r\n\t\t{\r\n\t\t\tDriver.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(10)); // for ajax calls\r\n\t\t\tUpdateWebConfig();\r\n\t\t}\r\n\r\n\t\t[TestFixtureTearDown]\r\n\t\tpublic void TearDown()\r\n\t\t{\r\n\t\t\tstring sitePath = AcceptanceTestsSetup.GetSitePath();\r\n\t\t\tstring webConfigPath = Path.Combine(sitePath, \"web.config\");\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\t// Remove any attachment folders used by the installer tests\r\n\t\t\t\tstring installerTestsAttachmentsPath = Path.Combine(sitePath, \"AcceptanceTests\");\r\n\t\t\t\tDirectory.Delete(installerTestsAttachmentsPath, true);\r\n\t\t\t\tConsole.WriteLine(\"Deleted temp attachment folders for installer tests\");\r\n\t\t\t}\r\n\t\t\tcatch { }\r\n\r\n\t\t\t// Reset the db and web.config back for all other acceptance tests\r\n\t\t\tCopyDb();\r\n\t\t\tAcceptanceTestsSetup.CopyWebConfig();\r\n\t\t\tConsole.WriteLine(\"Copied databases and web.config back for installer tests\");\r\n\t\t\tConsole.WriteLine(\"--- Finished installer acceptance test ---\");\r\n\t\t}\r\n\r\n\t\tprivate void UpdateWebConfig()\r\n\t\t{\r\n\t\t\tstring sitePath = AcceptanceTestsSetup.GetSitePath();\r\n\t\t\tstring webConfigPath = Path.Combine(sitePath, \"web.config\");\r\n\r\n\t\t\t// Remove the readonly flag from one of the installer tests (this could be fired in any order)\r\n\t\t\tFile.SetAttributes(webConfigPath, FileAttributes.Normal);\r\n\r\n\t\t\t// Switch installed=false in the web.config\r\n\t\t\tExeConfigurationFileMap fileMap = new ExeConfigurationFileMap();\r\n\t\t\tfileMap.ExeConfigFilename = webConfigPath;\r\n\t\t\tSystem.Configuration.Configuration config = ConfigurationManager.OpenMappedExeConfiguration(fileMap, ConfigurationUserLevel.None);\r\n\t\t\tRoadkillSection section = config.GetSection(\"roadkill\") as RoadkillSection;\r\n\r\n\t\t\tsection.Installed = false;\r\n\t\t\tconfig.ConnectionStrings.ConnectionStrings[\"Roadkill\"].ConnectionString = \"\";\r\n\t\t\tconfig.Save(ConfigurationSaveMode.Minimal);\r\n\r\n\t\t\tConsole.WriteLine(\"Updated {0} for installer tests\", webConfigPath);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Installation_Page_Should_Display_For_Home_Page()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElements(By.CssSelector(\"div#installer\")).Count, Is.EqualTo(1));\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Installation_PageShould_Display_For_Login_Page()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\t\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.Navigate().GoToUrl(LoginUrl);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElements(By.CssSelector(\"div#installer\")).Count, Is.EqualTo(1));\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step1_Web_Config_Test_Button_Should_Display_Success_Box_And_Continue_Link()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(2);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"div#webconfig-success\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\".continue > a\")).Displayed, Is.True);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step1_Web_Config_Test_Button_Should_Display_Error_Box_And_No_Continue_Link_For_Readonly_Webconfig()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tstring sitePath = AcceptanceTestsSetup.GetSitePath();\r\n\t\t\tstring webConfigPath = Path.Combine(sitePath, \"web.config\");\r\n\t\t\tFile.SetAttributes(webConfigPath, FileAttributes.ReadOnly);\r\n\t\t\tDriver.Wait(1);\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(2);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"div#webconfig-failure\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\".continue > a\")).Displayed, Is.False);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step2_Connection_Test_Button_Should_Display_Success_Box_For_Good_ConnectionString()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tSelectElement select = new SelectElement(Driver.FindElement(By.Id(\"DataStoreType_Name\")));\r\n\t\t\tselect.SelectByValue(DataStoreType.SqlServerCe.Name);\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(@\"Data Source=|DataDirectory|\\roadkill-acceptancetests.sdf\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testdbconnection]\")).Click();\r\n\t\t\tDriver.Wait(2);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"div#connectionsuccess\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"div#connectionfailure\")).Displayed, Is.False);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step2_Connection_Test_Button_Should_Display_Error_Box_For_Bad_ConnectionString()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tSelectElement select = new SelectElement(Driver.FindElement(By.Id(\"DataStoreType_Name\")));\r\n\t\t\tselect.SelectByValue(DataStoreType.SqlServerCe.Name);\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(@\"Data Source=|DataDirectory|\\madeupfilename.sdf\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testdbconnection]\")).Click();\r\n\t\t\tDriver.Wait(2);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"div#connectionfailure\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"div#connectionsuccess\")).Displayed, Is.False);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step2_Missing_Site_Name_Title_Should_Prevent_Contine()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).Clear();\r\n\t\t\tDriver.FindElement(By.Id(\"SiteUrl\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\".formErrorContent\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.Id(\"SiteName\")).Displayed, Is.True);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step2_Missing_Site_Url_Should_Prevent_Continue()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"SiteUrl\")).Clear();\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\".formErrorContent\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.Id(\"SiteUrl\")).Displayed, Is.True);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step2_Missing_ConnectionString_Should_Prevent_Contine()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"SiteUrl\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).Clear();\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\".formErrorContent\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.Id(\"ConnectionString\")).Displayed, Is.True);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step3_Missing_Admin_Email_Should_Prevent_Continue()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"SiteUrl\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"AdminEmail\")).Clear();\r\n\t\t\tDriver.FindElement(By.Id(\"AdminPassword\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"password2\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\".formErrorContent\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.Id(\"AdminEmail\")).Displayed, Is.True);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step3_Missing_Admin_Password_Should_Prevent_Continue()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"SiteUrl\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"AdminEmail\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"AdminPassword\")).Clear();\r\n\t\t\tDriver.FindElement(By.Id(\"password2\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\".formErrorContent\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.Id(\"AdminPassword\")).Displayed, Is.True);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step3_Not_Min_Length_Admin_Password_Should_Prevent_Continue()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"SiteUrl\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"AdminEmail\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"AdminPassword\")).SendKeys(\"1\");\r\n\t\t\tDriver.FindElement(By.Id(\"password2\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\".formErrorContent\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.Id(\"AdminPassword\")).Displayed, Is.True);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step3_Missing_Admin_Password2_Should_Prevent_Continue()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"SiteUrl\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"AdminEmail\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"AdminPassword\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"password2\")).Clear();\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\".formErrorContent\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.Id(\"password2\")).Displayed, Is.True);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step4_Test_Attachments_Folder_Button_With_Existing_Folder_Should_Display_Success_Box()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tstring sitePath = AcceptanceTestsSetup.GetSitePath();\r\n\t\t\tGuid folderGuid = Guid.NewGuid();\r\n\t\t\tstring attachmentsFolder = Path.Combine(sitePath, \"AcceptanceTests\", folderGuid.ToString());\t\t\r\n\t\t\tDirectory.CreateDirectory(attachmentsFolder);\r\n\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"SiteUrl\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"AdminEmail\")).SendKeys(\"admin@localhost\");\r\n\t\t\tDriver.FindElement(By.Id(\"AdminPassword\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"password2\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"AttachmentsFolder\")).Clear();\r\n\t\t\tDriver.FindElement(By.Id(\"AttachmentsFolder\")).SendKeys(\"~/AcceptanceTests/\" + folderGuid);\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testattachments]\")).Click();\r\n\t\t\tDriver.Wait(2);\r\n\r\n\t\t\t// Assert\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"div#attachmentssuccess\")).Displayed, Is.True);\r\n\t\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"div#attachmentsfailure\")).Displayed, Is.False);\r\n\t\t\t}\r\n\t\t\tfinally\r\n\t\t\t{\r\n\t\t\t\tDirectory.Delete(attachmentsFolder, true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Step4_Test_Attachments_Folder_Button_With_Missing_Folder_Should_Display_Failure_Box()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tstring sitePath = AcceptanceTestsSetup.GetSitePath();\r\n\t\t\tGuid folderGuid = Guid.NewGuid();\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"SiteUrl\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"AdminEmail\")).SendKeys(\"admin@localhost\");\r\n\t\t\tDriver.FindElement(By.Id(\"AdminPassword\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.Id(\"password2\")).SendKeys(\"not empty\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"AttachmentsFolder\")).Clear();\r\n\t\t\tDriver.FindElement(By.Id(\"AttachmentsFolder\")).SendKeys(\"~/\" + folderGuid);\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testattachments]\")).Click();\r\n\t\t\tDriver.Wait(2);\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"div#attachmentsfailure\")).Displayed, Is.True);\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"div#attachmentssuccess\")).Displayed, Is.False);\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void Navigation_Persists_Field_Values_Correctly()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tstring sitePath = AcceptanceTestsSetup.GetSitePath();\r\n\t\t\tGuid folderGuid = Guid.NewGuid();\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t// Act\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).Clear();\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).SendKeys(\"Site Name\");\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"SiteUrl\")).Clear();\r\n\t\t\tDriver.FindElement(By.Id(\"SiteUrl\")).SendKeys(\"Site Url\");\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).Clear();\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(\"Connection String\");\r\n\t\t\tSelectElement select = new SelectElement(Driver.FindElement(By.Id(\"DataStoreType_Name\")));\r\n\t\t\tselect.SelectByValue(DataStoreType.MySQL.Name);\r\n\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.previous a\")).Click();\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.previous a\")).Click();\r\n\r\n\t\t\t// Assert\r\n\t\t\tAssert.That(Driver.FindElement(By.Id(\"SiteName\")).GetAttribute(\"value\"), Is.EqualTo(\"Site Name\"));\r\n\t\t\tAssert.That(Driver.FindElement(By.Id(\"SiteUrl\")).GetAttribute(\"value\"), Is.EqualTo(\"Site Url\"));\r\n\t\t\tAssert.That(Driver.FindElement(By.Id(\"ConnectionString\")).GetAttribute(\"value\"), Is.EqualTo(\"Connection String\"));\r\n\r\n\t\t\tselect = new SelectElement(Driver.FindElement(By.Id(\"DataStoreType_Name\")));\r\n\t\t\tAssert.That(select.SelectedOption.GetAttribute(\"value\"), Is.EqualTo(DataStoreType.MySQL.Name));\r\n\t\t}\r\n\r\n\t\t[Test]\r\n\t\tpublic void All_Steps_With_Minimum_Required_Should_Complete()\r\n\t\t{\r\n\t\t\t// Arrange\r\n\t\t\tDriver.Navigate().GoToUrl(BaseUrl);\r\n\r\n\t\t\t//\r\n\t\t\t// ***Act***\r\n\t\t\t//\r\n\r\n\t\t\t// step 1\r\n\t\t\tDriver.FindElement(By.CssSelector(\"input[id=testwebconfig]\")).Click();\r\n\t\t\tDriver.Wait(0.5);\r\n\t\t\tDriver.FindElement(By.CssSelector(\".continue > a\")).Click();\r\n\r\n\t\t\t// step 2\r\n\t\t\tDriver.FindElement(By.Id(\"SiteName\")).SendKeys(\"Acceptance tests\");\r\n\t\t\tSelectElement select = new SelectElement(Driver.FindElement(By.Id(\"DataStoreType_Name\")));\r\n\t\t\tselect.SelectByValue(DataStoreType.SqlServerCe.Name);\r\n\r\n\t\t\tDriver.FindElement(By.Id(\"ConnectionString\")).SendKeys(@\"Data Source=|DataDirectory|\\roadkill-acceptancetests.sdf\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\t// step 3\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\t// step 3b\r\n\t\t\tDriver.FindElement(By.Id(\"AdminEmail\")).SendKeys(\"admin@localhost\");\r\n\t\t\tDriver.FindElement(By.Id(\"AdminPassword\")).SendKeys(\"password\");\r\n\t\t\tDriver.FindElement(By.Id(\"password2\")).SendKeys(\"password\");\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\t// step 4\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div.continue input\")).Click();\r\n\r\n\t\t\t//\r\n\t\t\t// ***Assert***\r\n\t\t\t//\r\n\t\t\tAssert.That(Driver.FindElement(By.CssSelector(\"div#installsuccess h1\")).Text, Is.EqualTo(\"Installation successful\"));\r\n\t\t\tDriver.FindElement(By.CssSelector(\"div#installsuccess a\")).Click();\r\n\t\t\tLoginAsAdmin();\r\n\t\t}\r\n\t}\r\n}\r\n"]],"start1":0,"start2":0,"length1":0,"length2":19601}]],"length":19601}
{"contributors":[],"silentsave":false,"ts":1362401084197,"patch":[[{"diffs":[[0,"\n\t\t\tDriver.Wait("],[-1,"2"],[1,"6"],[0,");\r\n\r\n\t\t\t// Asse"]],"start1":4975,"start2":4975,"length1":33,"length2":33},{"diffs":[[0,"\n\t\t\tDriver.Wait("],[-1,"2"],[1,"6"],[0,");\r\n\r\n\t\t\t// Asse"]],"start1":5900,"start2":5900,"length1":33,"length2":33}]],"length":19601,"saved":false}
{"contributors":[],"silentsave":false,"ts":1362411113583,"patch":[[{"diffs":[[0,"\n\t\t\tDriver.Wait("],[-1,"6"],[1,"10"],[0,");\r\n\r\n\t\t\t// Asse"]],"start1":4975,"start2":4975,"length1":33,"length2":34}]],"length":19602,"saved":false}
