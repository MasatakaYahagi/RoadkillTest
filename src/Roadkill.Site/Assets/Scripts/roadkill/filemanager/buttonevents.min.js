var Roadkill;(function(n){(function(n){(function(n){var t=function(){function t(){this._htmlBuilder=new n.HtmlBuilder,this._ajaxRequest=new n.AjaxRequest}return t.prototype.bind=function(){var n=this;$(document).on("click","#addfolderbtn",{instance:n},this.addFolderInput);$(document).on("click","#deletefolderbtn",{instance:n},this.deleteFolder);$(document).on("click","#deletefilebtn",{instance:n},this.deleteFile);$(document).on("keyup","#newfolderinput",{instance:n},this.addNewFolder);$(document).on("click","#newfoldercancel",{instance:n},this.cancelNewFolder)},t.prototype.deleteFolder=function(t){var f=t.data.instance,e=$("tr.select"),i=e.attr("data-urlpath"),r,u;if(i==""){alert(ROADKILL_DELETE_BASEFOLDER_ERROR);return}(r=n.Util.FormatString(ROADKILL_DELETE_CONFIRM,i),confirm(r))&&(u=function(t){if(t.status=="ok"){n.BreadCrumbTrail.removePriorBreadcrumb();var i=$("ul.navigator li:last-child").prev("li"),r=i.attr("data-urlpath");n.TableEvents.update(r)}else alert(t.message)},f._ajaxRequest.deleteFolder(i,u))},t.prototype.deleteFile=function(t){var e=t.data.instance,i=$("tr.select"),f;if(i.length>0&&i.attr("data-itemtype")=="file"){var r=n.TableEvents.getCurrentPath(),u=$("td.file",i).text(),o=n.Util.FormatString(ROADKILL_DELETE_CONFIRM,r+"/"+u);if(!confirm(o))return;f=function(n){n.status=="ok"?$(i).remove():alert(n.message)},e._ajaxRequest.deleteFile(u,r,f)}},t.prototype.addFolderInput=function(n){var r=n.data.instance,t,i;if($("tr#newfolderrow").length>0){$("#newfolderinput").focus();return}t=$("table#files tr[data-itemtype=folder]"),i=r._htmlBuilder.getNewFolder(),t.length>0?(t=t.last(),$(i).insertAfter(t)):$("table#files").append(i),$("#newfolderinput").focus()},t.prototype.addNewFolder=function(t){var i=t.data.instance,r,u;if(t.which==0||t.which==27)i.cancelNewFolder();else if(t.which==13){if(r=$("#newfolderinput").val(),r.replace(/\s/g,"").length==0){i.cancelNewFolder();return}u=function(t){if(t.status=="error"){alert(t.message);return}var i=$("ul.navigator li:last-child");n.TableEvents.update(i.attr("data-urlpath")),n.BreadCrumbTrail.removeLastItem(),$("tr#newfolderrow").remove()},i._ajaxRequest.newFolder(n.TableEvents.getCurrentPath(),r,u)}},t.prototype.cancelNewFolder=function(){$("tr#newfolderrow").remove()},t}();n.ButtonEvents=t})(n.FileManager||(n.FileManager={}));var t=n.FileManager})(n.Site||(n.Site={}));var t=n.Site})(Roadkill||(Roadkill={}))