var Roadkill;(function(n){(function(n){(function(n){var t=function(){function t(){this._htmlBuilder=new n.HtmlBuilder,this._ajaxRequest=new n.AjaxRequest}return t.prototype.bind=function(){$("#addfolderbtn").on("click",this.addFolderInput);$("#deletefolderbtn").bind("click",this.deleteFolder),$("#deletefilebtn").bind("click",this.deleteFile),$("#newfolderinput").live("keyup",this.addNewFolder),$("#newfoldercancel").live("click",this.cancelNewFolder)},t.prototype.deleteFolder=function(){var t=n.TableEvents.getCurrentPath(),i,r;if(t==""){alert(ROADKILL_DELETE_BASEFOLDER_ERROR);return}(i=n.Util.FormatString(ROADKILL_DELETE_CONFIRM,t),confirm(i))&&(r=function(t){if(t.status=="ok"){n.BreadCrumbTrail.removePriorBreadcrumb();var i=$("ul.navigator li:last-child").prev("li"),r=i.attr("data-urlpath");n.TableEvents.update(r)}else alert(t.message)},this._ajaxRequest.deleteFolder(t,r))},t.prototype.deleteFile=function(){var t=$("tr.select"),u;if(t.length>0&&t.attr("data-itemtype")=="file"){var i=n.TableEvents.getCurrentPath(),r=$("td.file",t).text(),f=n.Util.FormatString(ROADKILL_DELETE_CONFIRM,i+"/"+r);if(!confirm(f))return;u=function(n){n.status=="ok"?$(t).remove():alert(n.message)},this._ajaxRequest.deleteFile(r,i,u)}},t.prototype.addFolderInput=function(){if($("tr#newfolderrow").length>0){$("#newfolderinput").focus();return}var n=$("table#files tr[data-itemtype=folder]"),t=this._htmlBuilder.getNewFolder();n.length>0?(n=n.last(),$(t).insertAfter(n)):$("table#files").append(t),$("#newfolderinput").focus()},t.prototype.addNewFolder=function(t){var i,r;if(t.which==0||t.which==27)this.cancelNewFolder();else if(t.which==13){if(i=$("#newfolderinput").val(),i.replace(/\s/g,"").length==0){this.cancelNewFolder();return}r=function(t){if(t.status=="error"){alert(t.message);return}var i=$("ul.navigator li:last-child");this.getFolderInfo(i.attr("data-urlpath")),n.BreadCrumbTrail.removeLastItem(),$("tr#newfolderrow").remove()},this._ajaxRequest.newFolder(n.TableEvents.getCurrentPath(),i,r)}},t.prototype.cancelNewFolder=function(){$("tr#newfolderrow").remove()},t}();n.ButtonEvents=t})(n.FileManager||(n.FileManager={}));var t=n.FileManager})(n.Site||(n.Site={}));var t=n.Site})(Roadkill||(Roadkill={}))