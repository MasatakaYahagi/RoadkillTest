@model PageViewModel
@{
	ViewBag.Title = SiteStrings.EditPage_Title;
}
@Url.ScriptLinkForValidationLocalization()
<script type="text/javascript">
	$(document).ready(function ()
	{
		var pageTags = "@Html.Raw(Model.CommaDelimitedTags())";
		Roadkill.Site.EditPage.initializeTagManager(pageTags);
		$("#wysiwyg-toolbar button").popover({trigger: "hover", html: false, delay: { show: 250, hide: 100 } });
	});
</script>
<style>
	#container { width:100%;height:100%;overflow:auto; }
	.searchbar	{ display:none; }
</style>

<div id="editpage" class="row">
	<div id="editpage-form" class="col-sm-6">
		@Html.ValidationSummary(SiteStrings.EditPage_Error, new { @class = "alert alert-block alert-danger fade in", data_dismiss = "alert" })

		<form class="form-horizontal" role="form" method="post">
			@(Html.HiddenFor<PageViewModel, int>(p => p.Id))
			@(Html.HiddenFor<PageViewModel, string>(p => p.PreviousTitle))

			<div class="form-group">
				<div class="col-sm-12">
					@(Html.TextBoxFor<PageViewModel, string>(p => p.Title, new { @class = "validate[required] form-control", tabindex = 1, placeholder = SiteStrings.EditPage_Title_Label }))
				</div>
			</div>

			<div class="form-inline">
				@(Html.TextBox("TagsEntry", null, new { @class = "form-control tm-input", autocomplete = "off", tabindex = 2, placeholder = SiteStrings.EditPage_Tags_Label }))
			</div>


			@if (RoadkillContext.IsAdmin)
			{
				<h6>@(Html.CheckBoxFor<PageViewModel>(p => p.IsLocked, new { tabindex = 3 })) @SiteStrings.EditPage_AdminOnly</h6>
			}

			@Html.Partial("WysiwgToolbar")
			@(Html.TextAreaFor<PageViewModel, string>(p => p.Content, new { @class = "form-control", tabindex = 4 }))

			<div id="editpage-button-container" class="row" >
				<div class="col-sm-1">
				@if (Model.Id > 0)
				{
					<h6>@Html.ActionLink(SiteStrings.Button_Cancel, "Index", "Wiki", new { id = Model.Id, title = Url.EncodeTitle(Model.Title) }, null)</h6>
				}
				else
				{
					<h6>@Html.ActionLink(SiteStrings.Button_Cancel, "Index", "Wiki")</h6>
				}
				</div>
				<div id="editpage-save-button" class="col-sm-11"><!-- @SiteStrings.Button_Preview" -->
					<input type="submit" class="btn btn-primary saveButton" value="@SiteStrings.Button_Save" tabindex="5" />
				</div>
			</div>

			@Html.DialogPartial("ChooseImage")
			@Html.DialogPartial("MarkupHelp")
		</form>
	</div>

	<!-- Preview panel -->
	<div class="col-sm-5">
		<div class="panel panel-default">
			<div id="preview-heading" class="panel-heading">@SiteStrings.EditPage_Preview</div>
			<div class="panel-body" id="preview-wrapper">
				<div id="previewLoading" class="hide"><img src="@(Url.Content("~/Assets/Images/loading.gif"))" border="0" alt="loading" /></div>
				<div id="preview"><br class="clear" /></div>
			</div>
		</div>
	</div>

</div>

